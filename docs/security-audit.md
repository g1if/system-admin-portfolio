# Security Audit v2.0

Продвинутая система аудита безопасности с аналитикой уязвимостей, системой оценок и детализированными отчетами.

## 🚀 Особенности

- 🔍 **Комплексный аудит** - система, сеть, пользователи, процессы, конфигурации
- 📊 **Система оценок** - автоматический расчет балла безопасности (0-100)
- 🎯 **Приоритизация** - критические, высокие, средние, низкие уязвимости
- 🛡️ **Глубокая аналитика** - проверка ядра, SUID файлов, cron задач, процессов
- 📈 **Детальные отчеты** - автоматическая генерация отчетов с рекомендациями
- ⚙️ **Гибкая конфигурация** - настраиваемые проверки через конфигурационные файлы
- 🔄 **Мониторинг изменений** - отслеживание изменений в безопасности системы
- 📋 **База уязвимостей** - встроенная база известных уязвимостей и паттернов

## 🛠️ Использование

```bash
# Стандартный аудит с отчетом
./scripts/security-audit.sh

# Быстрая проверка
./scripts/security-audit.sh quick

# Глубокий аудит
./scripts/security-audit.sh deep

# Только генерация отчета
./scripts/security-audit.sh report

# Просмотр последнего балла
./scripts/security-audit.sh score

# Создание конфигурации
./scripts/security-audit.sh config

📊 Проверяемые области
🖥️ Системные обновления

    Доступные обновления - безопасность и обычные обновления

    Критические обновления - приоритетные обновления безопасности

    История обновлений - последние установленные обновления

🔐 Аутентификация и авторизация

    Парольная политика - срок жизни, сложность, история

    Пользователи - пустые пароли, просроченные аккаунты

    Привилегии - sudo настройки, права доступа

🌐 Сетевая безопасность

    SSH конфигурация - версия, аутентификация, порты

    Открытые порты - все слушающие порты и сервисы

    Файрвол - UFW, iptables, firewalld статус и правила

    Сетевые настройки - параметры ядра для сетевой безопасности

📁 Файловая система

    SUID/GUID файлы - потенциально опасные исполняемые файлы

    Права доступа - критические файлы конфигурации

    Подозрительные файлы - майнеры, бэкдоры, скрипты

⚙️ Конфигурация системы

    Параметры ядра - безопасность памяти, сети, процессов

    Сервисы - автоматически запускаемые сервисы

    Cron задачи - системные и пользовательские задания

🔄 Процессы и активность

    Подозрительные процессы - майнеры, сканеры, взломщики

    Скрытые процессы - процессы без записей в /proc

    Сетевая активность - подозрительные соединения

⚙️ Конфигурация

Создайте конфигурационный файл:
bash

./scripts/security-audit.sh config

Редактируйте configs/security-audit.conf:
bash

# Основные настройки
ENABLE_DEEP_SCAN=true
ENABLE_NETWORK_SCAN=true
SAVE_DETAILED_REPORTS=true

# Настройки сканирования
SCAN_USER_ACCOUNTS=true
SCAN_SERVICES=true
SCAN_NETWORK=true
SCAN_FILESYSTEM=true

# Пороговые значения
PASSWORD_MAX_DAYS=90
MIN_PASSWORD_LENGTH=8
ALLOW_ROOT_LOGIN=false
ALLOW_PASSWORD_AUTH=false

# Настройки безопасности
CHECK_SUID_FILES=true
CHECK_WRITABLE_DIRS=true
CHECK_HIDDEN_PROCESSES=true
CHECK_CRON_JOBS=true

# Настройки отчетов
SHOW_RECOMMENDATIONS=true
CALCULATE_SECURITY_SCORE=true

База уязвимостей (configs/vulnerability-patterns.conf)
bash

# Критические уязвимости
CRITICAL_PATTERNS=(
    "password.*null"
    "root.*ALL.*NOPASSWD"
    "PermitRootLogin.*yes"
)

# Подозрительные процессы
SUSPICIOUS_PROCESSES=(
    "minerd"
    "cpuminer"
    "xmrig"
    "sqlmap"
)

🎯 Система оценок
Уровни серьезности

    Критический (25+ баллов) - немедленное устранение требуется

    Высокий (15-24 балла) - устранение в ближайшее время

    Средний (5-14 баллов) - плановое устранение

    Низкий (1-4 балла) - рекомендации по улучшению

Интерпретация баллов

    90-100 - Отличная безопасность

    75-89 - Хорошая безопасность

    60-74 - Требует внимания

    40-59 - Плохая безопасность

    0-39 - Критическое состояние

🔧 Примеры использования
Стандартный аудит
bash

./scripts/security-audit.sh

Вывод:
text

🔒 ===========================================
   ПРОДВИНУТЫЙ АУДИТ БЕЗОПАСНОСТИ v2.0
   Tue Oct 28 23:45:30 PM EET 2025
   Автор: g1if
===========================================

🔍 ПРОВЕРКА ОБНОВЛЕНИЙ СИСТЕМЫ
  🔄 Проверка обновлений APT...
  ❌ Доступно обновлений: 15 (безопасность: 3) (-30)

🔍 РАСШИРЕННАЯ ПРОВЕРКА ПАРОЛЬНОЙ ПОЛИТИКИ
  📋 Текущая политика паролей:
    🔐 Макс. дней пароля: 180
    🔐 Мин. дней пароля: 1
    🔐 Предупреждение за дней: 7
    🔐 Мин. длина пароля: 6
  ❌ Слишком долгий срок жизни пароля (180 > 90) (-10)

🔍 УГЛУБЛЕННАЯ ПРОВЕРКА SSH БЕЗОПАСНОСТИ
  📁 Файл конфигурации: /etc/ssh/sshd_config
  ⚙️  Параметры SSH:
    🔑 Root доступ: yes
    🔑 Аутентификация паролем: yes
    🌐 Протокол: 2
    🚪 Порт: 22
    🔐 Макс. попыток аутентификации: 6
  🚨 Root доступ по SSH разрешен (-15)
  ❌ Аутентификация паролем разрешена (-10)
  ⚠️  SSH работает на стандартном порту 22 (-5)

🛡️  ИТОГОВЫЙ БАЛЛ БЕЗОПАСНОСТИ: 65/100
📊 Проблемы: Критических: 1, Высоких: 2, Средних: 2, Низких: 1

Глубокий аудит
bash

./scripts/security-audit.sh deep

Вывод:
text

[Все проверки стандартного аудита плюс:]

🔍 ПРОВЕРКА SUID/GUID ФАЙЛОВ
  🔍 Поиск SUID/GUID файлов (может занять время)...
  📊 Найдено SUID файлов: 45
  📊 Найдено GUID файлов: 23
  ✅ Количество SUID файлов в норме

🔍 ПРОВЕРКА СИСТЕМЫ ФАЙРВОЛА
  ✅ UFW включен (24 правил)
  📊 Статус файрвола:
    🛡️  Активный файрвол: Да
    📋 Всего правил: 24

🔍 ПРОВЕРКА НАСТРОЕК БЕЗОПАСНОСТИ ЯДРА
  ⚙️  Проверка параметров ядра:
    ✅ net.ipv4.ip_forward = 0
    ✅ kernel.dmesg_restrict = 1
    ❌ kernel.kptr_restrict = 0 (ожидается: 2)
    ...
  📊 Безопасность ядра: 75% (9/12)

🔍 ПОИСК ПОДОЗРИТЕЛЬНЫХ ПРОЦЕССОВ
  🔍 Сканирование процессов на подозрительную активность...
  ✅ Подозрительные процессы не обнаружены

🔍 ПРОВЕРКА CRON ЗАДАЧ
  ⏰ Проверка системных cron задач...
    📋 Системных cron задач: 8
    📁 /etc/cron.hourly: 0 файлов
    📁 /etc/cron.daily: 4 файлов
  ✅ Подозрительные cron задачи не обнаружены

Просмотр балла безопасности
bash

./scripts/security-audit.sh score

Вывод:
text

Последний балл безопасности: 78/100

📈 Ключевые функции
Автоматическая оценка безопасности

    Взвешенная система - разные веса для разных типов уязвимостей

    Приоритизация - цветовое кодирование серьезности проблем

    Тренды - отслеживание изменений балла со временем

Глубокая аналитика

    Параметры ядра - 12+ критических параметров безопасности

    Сетевой анализ - детальная проверка всех сетевых служб

    Анализ процессов - обнаружение скрытых и подозрительных процессов

Гибкая конфигурация

    Модульность - включение/выключение отдельных проверок

    Настраиваемые пороги - адаптация под конкретные требования

    Расширяемая база - легко добавлять новые паттерны уязвимостей

Детальная отчетность

    Структурированные отчеты - логическая группировка проблем

    Конкретные рекомендации - actionable советы по улучшению

    Исторические данные - сравнение с предыдущими аудитами

🔧 Технические особенности
Производительность

    Кэширование - оптимизация повторных проверок

    Параллельные проверки - одновременное выполнение независимых тестов

    Эффективные команды - использование оптимальных параметров

Надежность

    Обработка ошибок - graceful degradation при проблемах

    Валидация данных - проверка корректности собранной информации

    Логирование - детальная запись всех операций

Совместимость

    Мульти-дистрибутивность - поддержка основных Linux систем

    Адаптация - автоматическое определение доступных утилит

    Минимальные зависимости - работа с базовым набором инструментов

📁 Структура данных
Отчеты
text

reports/
└── security-audit-20251028_234530.txt

Конфигурации
text

configs/
├── security-audit.conf
└── vulnerability-patterns.conf

Кэш и баллы
text

cache/
├── security-cache.db
└── security-score.txt

Логи
text

logs/
└── security-audit.log

🐛 Диагностика
Тестирование системы
bash

# Быстрая проверка
./scripts/security-audit.sh quick

# Проверка конкретной области
./scripts/security-audit.sh deep | grep -A 10 "SSH"

Отладка проблем
bash

# Подробное логирование
tail -f logs/security-audit.log

# Просмотр последнего отчета
cat reports/security-audit-*.txt | less

🔮 Интеграции
С системой оповещений
bash

# Критический балл безопасности
score=$(./scripts/security-audit.sh score)
if [ "$score" -lt 60 ]; then
    ./scripts/alert-system.sh "🚨 Критический балл безопасности: $score"
fi

# Обнаружение подозрительных процессов
if ./scripts/security-audit.sh deep | grep -q "🚨 Найден:"; then
    ./scripts/alert-system.sh "⚠️  Обнаружены подозрительные процессы"
fi

С планировщиком задач
bash

# Еженедельный полный аудит
0 2 * * 1 /path/to/scripts/security-audit.sh deep

# Ежедневная быстрая проверка
0 9 * * * /path/to/scripts/security-audit.sh quick

# Ежемесячный отчет
0 6 1 * * /path/to/scripts/security-audit.sh report

🤝 Совместимость

    ✅ Дистрибутивы: Ubuntu 16.04+, Debian 9+, CentOS 7+, RHEL 7+, Fedora

    ✅ Архитектуры: x86_64, ARM, ARM64

    ✅ Утилиты: базовые системные утилиты + опциональные для расширенных функций

👨💻 Автор

g1if

Примечание: Система автоматически адаптируется к доступным утилитам и предоставляет максимально подробную информацию в рамках возможностей системы. Все проверки модульны и могут быть отключены в конфигурации.
text


## 🚀 **ОСНОВНЫЕ УЛУЧШЕНИЯ В ВЕРСИИ 2.0**

1. ✅ **Система оценок безопасности** - автоматический расчет балла (0-100)
2. ✅ **Приоритизация уязвимостей** - критические, высокие, средние, низкие
3. ✅ **Расширенные проверки** - ядро, процессы, cron, SUID файлы
4. ✅ **База уязвимостей** - встроенная база известных паттернов
5. ✅ **Детальная аналитика** - 12+ параметров ядра, сетевой анализ, процессы
6. ✅ **Гибкая конфигурация** - модульные проверки через конфигурационные файлы
7. ✅ **Автоматические отчеты** - структурированные отчеты с рекомендациями
8. ✅ **Мониторинг изменений** - отслеживание балла безопасности во времени
9. ✅ **Кэширование** - оптимизация производительности
10. ✅ **Расширенная обработка ошибок** - надежная работа в различных окружениях
